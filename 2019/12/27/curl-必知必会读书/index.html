<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>&lt;Curl 必知必会&gt;读书 - emacsist</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="emacsist" />
  <meta name="description" content="curl 项目 Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护. 1997年 4 月 8 号" />

  <meta name="keywords" content="Golang, Java, PostgreSQL, Postgres, MySQL, emacsist, RabbitMQ, Go, emacs, orgmode" />






<meta name="generator" content="Hugo 0.58.3" />


<link rel="canonical" href="https://emacsist.github.io/2019/12/27/curl-%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E8%AF%BB%E4%B9%A6/" />

<link href="." rel="alternate" type="application/rss+xml" title="emacsist" />
<link href="." rel="feed" type="application/rss+xml" title="emacsist" />



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">




<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<link href="/dist/even.min.css?v=3.1.1" rel="stylesheet">





<meta property="og:title" content="&lt;Curl 必知必会&gt;读书" />
<meta property="og:description" content="curl 项目 Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护. 1997年 4 月 8 号" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://emacsist.github.io/2019/12/27/curl-%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A%E8%AF%BB%E4%B9%A6/" />
<meta property="article:published_time" content="2019-12-27T16:50:32+08:00" />
<meta property="article:modified_time" content="2019-12-27T16:50:32+08:00" />
<meta itemprop="name" content="&lt;Curl 必知必会&gt;读书">
<meta itemprop="description" content="curl 项目 Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护. 1997年 4 月 8 号">


<meta itemprop="datePublished" content="2019-12-27T16:50:32&#43;08:00" />
<meta itemprop="dateModified" content="2019-12-27T16:50:32&#43;08:00" />
<meta itemprop="wordCount" content="2894">



<meta itemprop="keywords" content="curl," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="&lt;Curl 必知必会&gt;读书"/>
<meta name="twitter:description" content="curl 项目 Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护. 1997年 4 月 8 号"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">emacsist</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">emacsist</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">&lt;Curl 必知必会&gt;读书</h1>

      <div class="post-meta">
        <span class="post-time"> 2019-12-27 </span>
        
        <span class="more-meta"> 2894 words </span>
        <span class="more-meta"> 6 mins read </span>
        <span id="busuanzi_container_page_pv" class="more-meta"> <span id="busuanzi_value_page_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> times read </span>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#curl-项目">curl 项目</a></li>
<li><a href="#选项和参数">选项和参数</a>
<ul>
<li><a href="#多个-url">多个 URL</a>
<ul>
<li><a href="#多个-url-与下载">多个 URL 与下载</a></li>
</ul></li>
<li><a href="#url-的单独选项">URL 的单独选项</a>
<ul>
<li><a href="#用户名和密码">用户名和密码</a></li>
<li><a href="#进度指示器">进度指示器</a></li>
</ul></li>
<li><a href="#连接重用">连接重用</a></li>
<li><a href="#通配">通配</a>
<ul>
<li><a href="#范围">范围 <code>[]</code></a></li>
<li><a href="#列表">列表 <code>{}</code></a></li>
<li><a href="#组合">组合</a></li>
<li><a href="#输出">输出</a></li>
</ul></li>
</ul></li>
<li><a href="#详细模式">详细模式</a>
<ul>
<li><a href="#write-out"><code>--write-out</code></a></li>
</ul></li>
<li><a href="#静默模式">静默模式</a></li>
<li><a href="#下载">下载</a>
<ul>
<li><a href="#速率">速率</a></li>
<li><a href="#大小">大小</a></li>
<li><a href="#metalink">metalink</a></li>
<li><a href="#原始-raw">原始 <code>--raw</code></a></li>
<li><a href="#失败重试">失败重试</a></li>
<li><a href="#恢复下载和下载范围">恢复下载和下载范围</a></li>
</ul></li>
<li><a href="#上传">上传</a>
<ul>
<li><a href="#post-上传">POST 上传</a></li>
<li><a href="#multipart-formpost-上传">Multipart formpost 上传</a></li>
<li><a href="#put-上传">PUT 上传</a></li>
<li><a href="#ftp上传">FTP上传</a></li>
<li><a href="#速度">速度</a></li>
</ul></li>
<li><a href="#主机解析">主机解析</a>
<ul>
<li><a href="#hosts-文件">hosts 文件</a></li>
<li><a href="#host-header">Host Header</a></li>
<li><a href="#自定义-ip">自定义 IP</a></li>
<li><a href="#提供替换名">提供替换名</a></li>
</ul></li>
<li><a href="#连接相关">连接相关</a>
<ul>
<li><a href="#keepalive">keepalive</a></li>
<li><a href="#速率控制及退出">速率控制及退出</a></li>
</ul></li>
<li><a href="#代理">代理</a>
<ul>
<li><a href="#代理环境变量">代理环境变量</a></li>
</ul></li>
<li><a href="#http-操作">HTTP 操作</a>
<ul>
<li><a href="#方法">方法</a></li>
<li><a href="#认证">认证</a></li>
<li><a href="#区间">区间</a></li>
<li><a href="#http-版本">HTTP 版本</a></li>
<li><a href="#post">POST</a>
<ul>
<li><a href="#content-type"><code>Content-Type</code></a></li>
<li><a href="#二进制内容">二进制内容</a></li>
<li><a href="#url-encode">URL encode</a></li>
<li><a href="#转换为-get">转换为 GET</a></li>
<li><a href="#发送表单-form">发送表单 form</a></li>
<li><a href="#请求头">请求头</a></li>
<li><a href="#referer">referer</a></li>
<li><a href="#ua">ua</a></li>
<li><a href="#cookie">cookie</a></li>
<li><a href="#http2">http2</a></li>
</ul></li>
</ul></li>
<li><a href="#参考资料">参考资料</a></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h1 id="curl-项目">curl 项目</h1>

<ul>
<li>Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护.</li>
<li>1997年 4 月 8 号 HttpGet 1.0 发布</li>
<li>1997年 8 月 urlget 2.0</li>
<li>1998 年 3 月 20 号 curl 4</li>
<li>2000 年 8 月 libcurl 7.1 发布</li>
</ul>

<h1 id="选项和参数">选项和参数</h1>

<p><code>短选项</code>  : 例如 <code>-v</code> 或 <code>-L</code> 或它们的组合 <code>-vL</code></p>

<p><code>长选项</code> : 使用 <code>--</code> 两个减号, 后加选项名. 例如 <code>--verbose</code> <code>--location</code></p>

<p><code>选项的参数</code> : <code>-k v</code> , 即中间用空格分隔. <code>如果使用了短选项方式, 则可不使用空格分隔</code></p>

<p>值包含空格, 则要用<code>双引号</code>来引用.(大多情况下建议, 有些系统也可用单引号)</p>

<p><code>负选项</code> :  <code>--no-</code>  前缀. 例如关闭详细模式, <code>--no-verbose</code></p>

<ul>
<li><code>-K</code> 或 <code>--config</code>: 通过文件或标准输入来提供命令行选项.(即配置文件).

<ul>
<li>查找主目录. <code>CURL_HOME</code> 环境变量, 如果没有则是 <code>HOME</code> 环境变量.</li>
<li>默认情况下, 它会从<code>主目录</code> 找 <code>~/.curlrc</code> 文件中读取.</li>
<li>以 <code>#</code> 开头的表示是注释</li>
<li>每一行表示一个参数</li>
<li>如果是 <code>-K -</code> 表示从 stdin 读入.</li>
</ul></li>
<li><code>-v</code> : 详细输出</li>
<li><code>--proto-default</code> : 修改默认协议(默认为 HTTP)</li>
<li><code>--fail-early</code> 处理多个 URL 时快速失败. 默认 curl 会处理完最后一个 URL 后返回一个退出码. 这个参数表示第一次出现错误就立即退出. 多 URL 请看下面的部分.</li>
<li><code>-s</code> 或 <code>--silent</code> : 关闭进度指示器</li>
<li>保存文件名相关(注意, curl 下载并不会对数据进行任何转换, 字符问题可用 <code>iconv</code> 来转换)

<ul>
<li><code>-o</code> : 指定下载保存的文件名. (字母小写 o)</li>
<li><code>-O</code> : 使用 URL 最后的路径名作为保存的文件名. (字母大写 O)</li>
<li><code>-J</code> 或 <code>--remote-header-name</code> : 使用 HTPP 响应头的 <code>Content-Disposition</code> 建议的文件名来作为保存名(要注意小心被覆盖或字符集问题)</li>
</ul></li>
<li><code>--compressed</code> : 建议服务器压缩来传输.</li>
</ul>

<h2 id="多个-url">多个 URL</h2>

<p>curl 支持无限数量的 URL . 只要你的 shell 系统支持. 如果有非常多的URL 的话. 可以这样子用</p>

<pre><code class="language-bash">xargs curl  &lt; /tmp/urls
</code></pre>

<blockquote>
<p>注意, 指定多个 URL , 它是按顺序一个一个处理. 前一个没处理完, 是不是处理下一个 URL</p>
</blockquote>

<h3 id="多个-url-与下载">多个 URL 与下载</h3>

<pre><code class="language-bash"># 注意单个 -o 或 -O , 只用于单个下载. 如果要下载多个 URL , 则需要使用多个 -o 或 -O
# 例如
curl -O -O http://hello.com/1.txt http://hello.com/2.txt

# 更为方便的用法. 以下表示所有都使用 -O 选项作为默认
curl --remote-name-all http://hello.com/1.txt http://hello.com/2.txt
</code></pre>

<h2 id="url-的单独选项">URL 的单独选项</h2>

<pre><code class="language-bash">curl -L www.qq.com --next -X GET www.qq.com --next -I www.qq.com
</code></pre>

<p><code>--next</code> 或 <code>-;</code> 用于在一组选项和 URL 之间插入间隔. 遇到 <code>--next</code> 时, 它会将后面的选项应用到下一组 URL .</p>

<h3 id="用户名和密码">用户名和密码</h3>

<pre><code class="language-bash">curl -u name:passwd http://www.fuck.com
</code></pre>

<p>可以指定 u 而没带参数值, 则会自动提示叫你输入</p>

<h3 id="进度指示器">进度指示器</h3>

<p>默认开启. 可以通过 <code>-s</code> 或 <code>--silent</code> 禁用.</p>

<p>例子</p>

<pre><code class="language-bash">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 21946  100 21946    0     0   157k      0 --:--:-- --:--:-- --:--:--  158k
</code></pre>

<p>从左到右:</p>

<ul>
<li><code>%</code>: 整个传输百分比</li>
<li><code>Total</code> : 整个传输的总大小</li>
<li><code>%</code> : 已完成的下载百分比</li>
<li><code>Received</code> : 已下载字节数</li>
<li><code>%</code> : 已完成的上传百分比</li>
<li><code>Xferd</code> : 已上传字节数</li>
<li><code>Average Speed Dload</code> : 整个下载的平均速度. 单位 <code>byte/s</code></li>
<li><code>Average Speed Upload</code> : 整个上传的平均速度. 单位 <code>byte/s</code></li>
<li><code>Time Total</code> : 预期完成操作时间. <code>HH:MM:ss</code></li>
<li><code>Time Current</code> : 从传输开始到现在的时间. <code>HH:MM:ss</code></li>
<li><code>Time Left</code> : 预期完成操作所需要的剩余时间. <code>HH:MM:ss</code></li>
<li><code>Curr.Speed</code> : 过去 5 秒的平均传输速度. <code>byte/s</code></li>
</ul>

<h2 id="连接重用">连接重用</h2>

<p>在运行期间的 curl 内部会维护一个连接池. 所以, 最好在同一个命令中完成多次传输, 而不是单独运行多个 curl 命令</p>

<pre><code class="language-bash">* Connected to www.qq.com (113.96.232.215) port 80 (#0)
</code></pre>

<p><code>(#0)</code> 这个就是 curl 为这个连接分配的内部数字.</p>

<blockquote>
<p>但只要 curl 退出后， 它就会关闭所有已打开的连接和连接池的连接</p>
</blockquote>

<h2 id="通配">通配</h2>

<p>默认 curl 使用 <code>[]</code> 和 <code>{}</code> 进行通配. 可以通过 <code>-g</code> 或 <code>--globoff</code> 禁用它.</p>

<h3 id="范围">范围 <code>[]</code></h3>

<pre><code class="language-bash">curl -O http://example.com/[1-100].png
# 零前缀
curl -O http://example.com/[001-100].png
# 步进
curl -O http://example.com/[0-100:2].png
</code></pre>

<h3 id="列表">列表 <code>{}</code></h3>

<pre><code class="language-bash">curl -O http://example.com/{one,two,three,alpha,beta}.html
# 组合
curl -O http://example.com/{Ben,Alice,Frank}-{100x100,1000x1000}.jpg
</code></pre>

<h3 id="组合">组合</h3>

<pre><code class="language-bash">curl -O http://example.com/{web,mail}-log[0-6].txt
</code></pre>

<h3 id="输出">输出</h3>

<p>可以在输出时引用通配变量</p>

<pre><code class="language-bash">curl http://{one,two}.example.com -o &quot;file_#1.txt&quot;

curl http://{site,host}.host[1-5].example.com -o &quot;subdir/#1_#2&quot;
</code></pre>

<h1 id="详细模式">详细模式</h1>

<ul>
<li><code>-v</code></li>
<li><code>--trace [filename]</code> 将完整的跟踪信息保存在指定文件. (包括实际传输数据在内的完整消息)</li>
<li><code>--trace-ascii [filename]</code> : 同上, 但输出的是 ASCII 字符, 而不是十六进制数字</li>

<li><p><code>--trace-time</code> : 加上高精度时间</p>

<pre><code class="language-bash">curl --trace /tmp/curl.tarce http://www.qq.com
# 或输出到控制台:
curl --trace - http://www.qq.com
</code></pre></li>
</ul>

<h2 id="write-out"><code>--write-out</code></h2>

<p>或 <code>-w</code> 它可在传输任务完成后打印一些信息.</p>

<ul>
<li>字符串 <code>-w &quot;hello&quot;</code></li>
<li>从文件读取 <code>-w @/path/to/filename</code></li>
<li>从标准输入读取 <code>-w @-</code></li>
<li>可在字符串中使用 <code>%{var_name}</code> 来访问可用变量.</li>
</ul>

<p>可用的变量有</p>

<ul>
<li><code>%{content_type}</code> : 显示 <code>ContentType</code></li>
<li><code>%{filename_effective}</code> : 显示 curl 最终写入内容的文件名. 只有使用 <code>--remote-name</code> 或 <code>--output</code> 选项写入文件才有意义. 与 <code>--remote-header-name</code> 选项结合最有用.</li>
<li><code>%{ftp_entry_path}</code> : 显示连接到远程 FTP 服务器时的初始路径</li>
<li><code>%{response_code}</code> : 显示最后一次传输返回的响应码</li>
<li><code>%{http_connect}</code> : 显示最近一次会对 CONNECT 请求的响应码(来自代理)</li>
<li><code>%{local_ip}</code> : 显示最近一次连接的本地 IP 地址</li>
<li><code>%{local_port}</code> : 显示最近一次连接的端口号</li>
<li><code>%{num_connects}</code> : 显示最近一次传输建立的新连接的数量</li>
<li><code>%{num_redirects}</code> : 显示请求的重定向次数</li>
<li><code>%{redirect_url}</code> : 显示不使用 <code>-L</code> 时的重定向 URL</li>
<li><code>%{remote_ip}</code> : 显示最近一次连接的远程 IP 地址</li>
<li><code>%{remote_port}</code> : 显示最近一次连接的远程端口</li>
<li><code>%{size_download}</code> :  显示已下载的总字节数</li>
<li><code>%{size_header}</code> :  显示已下载 header 的总字节数</li>
<li><code>%{size_request}</code> : 显示 HTTP 请求发送的总字节数</li>
<li><code>%{size_upload}</code> :  已上传的总字节数</li>
<li><code>%{speed_download}</code> : 显示整个下载的平均速率. <code>byte/s</code></li>
<li><code>%{speed_upload}</code> :  显示整个上传的平均速率</li>
<li><code>%{ssl_verify_result}</code> : 显示 SSL 验证结果。 0 表示成功.</li>
<li><code>%{time_appconnect}</code>: 从开始到远程主机建立 SSL 或 SSH 连接所花费的时间。 以秒为单位</li>
<li><code>%{time_connect}</code> ： 显示从开始到远程主机建立 TCP 所花费的时间。 以秒为单位</li>
<li><code>%{time_namelookup}</code> : 显示从开始到完成解析域名所花的时间。以秒为单位</li>
<li><code>%{time_pretransfer}</code> ： 显示从开始到文件传输即将开始所花的时间。 包括用于所有预传输命令以及特定协议协商的时间， 以秒为单位。</li>
<li><code>%{time_redirect}</code> : 显示重定向所花的时间， 包括在最终事务启动之前的域名查找， 建立连接， 预传输和传输。 以秒为单位</li>
<li><code>%{time_starttransfer}</code> ： 从开始到第一个字节即将开始传输所花的时间。 包括 <code>time_pretransfer</code> 以及服务器计算结果所需要的时间， 以秒为单位。</li>
<li><code>%{time_total}</code> ： 显示整个操作持续的时间。 以秒为单位。</li>
<li><code>%{url_effective}</code> ： 显示最后获取的 URL。 如果你要 curl 跟随重定向（<code>-L</code> ）， 那这人变量就非常有用</li>
</ul>

<h1 id="静默模式">静默模式</h1>

<p><code>-s</code> 或 <code>--silent</code>  ， 不会在发生错误时输出任何错误信息。 但仍会处理。</p>

<p>可添加 <code>-S</code> 或 <code>--show-error</code> 来显示有错误时显示错误信息</p>

<h1 id="下载">下载</h1>

<h2 id="速率">速率</h2>

<pre><code class="language-bash">curl http://qq.com --limit-rate 200[K|M|G]
</code></pre>

<h2 id="大小">大小</h2>

<pre><code class="language-bash"># 单位字节
curl http://qq.com --max-filesize 100000 
</code></pre>

<h2 id="metalink">metalink</h2>

<pre><code class="language-bash">curl --metalink https://hello.com/example.metalink
</code></pre>

<h2 id="原始-raw">原始 <code>--raw</code></h2>

<p>这个选项会禁用所有内部的 HTTP 内容解码或传输编码.<code>比如开发中间件时就很有用</code>.</p>

<h2 id="失败重试">失败重试</h2>

<ul>
<li><code>--retry</code> : 设置重试次数. 默认为 0 即不重试.</li>
<li><code>--retry-delay</code> : 禁用指数退避算法, 并设置自己的重试延迟. 默认重试等待时间为 <code>延时 1 秒, 2 秒, 4 秒</code> 这种指数加倍.</li>
<li><code>--retry-max-time</code> : 限制所有重试的总时间</li>
<li><code>--max-time</code> : 用于指定单个传输允许的最长时间</li>
<li><code>--connect-timeout</code> :  连接超时. <code>--connect-timeout 2.71</code> 表示 2710 毫秒</li>
</ul>

<h2 id="恢复下载和下载范围">恢复下载和下载范围</h2>

<ul>
<li><code>-C</code> 或 <code>--continu-at</code> : 指定从某个数字字节偏移量开始. 用 <code>-</code> 的话, 表示让 curl 自动决定.</li>
<li><code>--range X-Y</code> : 表示只从某范围下载数据</li>
</ul>

<h1 id="上传">上传</h1>

<h2 id="post-上传">POST 上传</h2>

<h2 id="multipart-formpost-上传">Multipart formpost 上传</h2>

<h2 id="put-上传">PUT 上传</h2>

<pre><code class="language-bash">curl -T uploadthis http://example.com/
</code></pre>

<h2 id="ftp上传">FTP上传</h2>

<pre><code class="language-bash">curl -T uploadthis ftp://example.com/dir/
curl -T uploadthis ftp://example.com/dir/newName
</code></pre>

<h2 id="速度">速度</h2>

<p>参考 <code>--limit-rate</code></p>

<h1 id="主机解析">主机解析</h1>

<h2 id="hosts-文件">hosts 文件</h2>

<pre><code class="language-bash">127.0.0.1 example.com
</code></pre>

<h2 id="host-header">Host Header</h2>

<pre><code class="language-bash">curl -H &quot;Host: www.example.com&quot; http://localhost/
</code></pre>

<h2 id="自定义-ip">自定义 IP</h2>

<pre><code class="language-bash">curl --resolve example.com:80:127.0.0.1 http://example.com/
</code></pre>

<h2 id="提供替换名">提供替换名</h2>

<pre><code class="language-bash">curl --connect-to www.example.com:80:newName.example.com:80 http://www.example.com
</code></pre>

<p>它将 <code>www.example.co:80</code>  重定向到 <code>newName.examp</code></p>

<h1 id="连接相关">连接相关</h1>

<ul>
<li><code>--connect-timeout</code> : 连接超时</li>
<li><code>--max-time</code> 或 <code>-m</code>: 总用时</li>
<li><code>--interface</code> : 使用指定本地网卡或 IP

<ul>
<li><code>--interface eth1</code></li>
<li><code>--interface 192.168.1.10</code></li>
</ul></li>
<li><code>--local-port 4200~4205</code> : 使用指定本地端口范围来进行连接</li>
</ul>

<h2 id="keepalive">keepalive</h2>

<p>默认情况下, curl 启用 tcp keepalive.</p>

<ul>
<li><code>--no-keepalive</code>  表示禁用 tcp keepalive</li>
<li><code>--keepalive-time 300</code> : keepalive 发送心跳的间隔, 单位秒</li>
</ul>

<h2 id="速率控制及退出">速率控制及退出</h2>

<pre><code class="language-bash">curl --speed-time 15 --speed-limit  1000 http://example.com
</code></pre>

<p>表示在 15 <code>秒</code>内的传输速率低于 1000 <code>byte/s</code> , 则停止.</p>

<h1 id="代理">代理</h1>

<pre><code class="language-bash"># 小写字母 x, 表示通过代理服务器 192.168.0.1:8080 来访问 exapmle.com
curl -x 192.168.0.1:8080 http://example.com
curl -x 192.168.0.1:8080 https://example.com
</code></pre>

<h2 id="代理环境变量">代理环境变量</h2>

<pre><code class="language-bash">http_proxy=http://proxy.example.com:80
ftp_proxy=xxx
# https 协议时使用这个代理
https_proxy=yyyy
# 所有协议都使用这个代理
ALL_PROXY=NNNN
# 指定某些 host 不需要通过代理
NO_PROXY=www.example.com,www.no-proxy.com
curl -v www.example.com
</code></pre>

<h1 id="http-操作">HTTP 操作</h1>

<h2 id="方法">方法</h2>

<ul>
<li>默认为 <code>GET</code></li>
<li><code>-d</code> 或 <code>-F</code> 为 POST</li>
<li><code>-I</code> 为 HEAD</li>
<li><code>-T</code> 为 PUT</li>
</ul>

<h2 id="认证">认证</h2>

<pre><code class="language-bash">curl --user name:pwd http://hello.com/

# 自动使用最安全的方法
curl --anyauth --user name:pwd http://hello.com/

# 指定方法
curl --digest --user daniel:secret http://example.com/ 
curl --negotiate --user daniel:secret http://example.com/ 
curl --ntlm --user daniel:secret http://example.com/
</code></pre>

<h2 id="区间">区间</h2>

<pre><code class="language-bash">curl -r 0-199 http://example.com
curl -r 200- http://example.com
curl -r 0-199,1000-199 http://example.com/
</code></pre>

<h2 id="http-版本">HTTP 版本</h2>

<ul>
<li><code>--http1.0</code></li>
<li><code>--http1.1</code></li>
<li><code>--http2</code></li>
<li><code>--http2-prior-knowledge</code></li>
<li><code>--http3</code></li>
</ul>

<h2 id="post">POST</h2>

<pre><code class="language-bash">curl -d 'name=admin&amp;shoesize=12' http://example.com/
# curl 自动会将它们串连起来, 并插入 &amp; 字符
curl -d name=admin -d shoesize=12 http://example.com/

# 文件
curl -d @filename http://example.com
</code></pre>

<h3 id="content-type"><code>Content-Type</code></h3>

<p>默认使用 <code>-d</code> 时的 <code>content-type</code> 为 <code>Content-Type: application/x-www-form-urlencoded</code></p>

<p>指定为 JSON</p>

<pre><code class="language-bash">curl -d '{json}' -H 'Content-Type: application/json' https://example.com
</code></pre>

<h3 id="二进制内容">二进制内容</h3>

<pre><code class="language-bash">curl --data-binary @filename http://example.com/
</code></pre>

<p>如果使用 <code>-d</code> 的话, 回车符和换行符会被移除. 但使用 <code>--data-binary</code> 则表示原始数据</p>

<h3 id="url-encode">URL encode</h3>

<pre><code class="language-bash"># 编码后为 name=John%20Doe%20%28Junior%29
curl --data-urlencode &quot;name=John Doe (Junior)&quot; http://example.com

# 如果内容保存在文件. 表示使用 user 作为参数名. contents.txt 的内容作为值并编码
curl --data-urlencode user@contents.txt http://example.com

# 如果 name 也想编码. 表示参数名为 `user name`, 前面的等号并不会发送
curl --data-urlencode &quot;=user name=John Doe (Junior)&quot; http://example.com
</code></pre>

<h3 id="转换为-get">转换为 GET</h3>

<p>使用 <code>-G</code> 或 <code>--get</code> 选项, 它将 <code>-d</code> 指定的数据附加到 URL 右边, 并使用 <code>?</code> 分隔.</p>

<h3 id="发送表单-form">发送表单 form</h3>

<p>通过 <code>-F</code> 或 <code>--form</code> 选项添加单独的 <code>multipart</code> .</p>

<pre><code class="language-bash">curl -F person=anonymous -F secret=@file.txt http://example.com/submit.cgi
</code></pre>

<h3 id="请求头">请求头</h3>

<pre><code class="language-bash"># 添加
curl -H &quot;name: value&quot; http://example.com/

# 删除. name 后分号
curl -H &quot;name;&quot; http://example.com/
</code></pre>

<h3 id="referer">referer</h3>

<pre><code class="language-bash">curl --referer http://comes-from.example.com https://www.example.com/
</code></pre>

<h3 id="ua">ua</h3>

<pre><code class="language-bash">curl -A &quot;new agent&quot; http://example.com
curl --user-agent http://example.com
curl -H &quot;User-Agent: new agent&quot; http://example.com
</code></pre>

<h3 id="cookie">cookie</h3>

<pre><code class="language-bash"># 从指定文件中读取 cookie
curl -L -b cookies.txt http://example.com

# 保存 cookie 到文件
curl -c cookie-jar.txt http://example.com

# 新 cookie 会话
curl -j -b cookies.txt http://example.com/
</code></pre>

<h3 id="http2">http2</h3>

<pre><code class="language-bash">curl --http2 http://example.com/
</code></pre>

<h1 id="参考资料">参考资料</h1>

<ul>
<li><a href="https://curl.haxx.se/docs/manual.html">https://curl.haxx.se/docs/manual.html</a></li>
<li><a href="https://curl.haxx.se/docs/manpage.html">https://curl.haxx.se/docs/manpage.html</a></li>
<li><a href="https://github.com/bagder/everything-curl/blob/master/cmdline-globbing.md">https://github.com/bagder/everything-curl/blob/master/cmdline-globbing.md</a></li>
</ul>

    </div>

    
    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">emacsist</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">2019-12-27</span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>

    
    
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">Reward</label>
  <div class="qr-code">
    
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/img/wxpay.jpeg">
        <span>wechat</span>
      </label>
    
      <label class="qr-code-image" for="reward">
        <img class="image" src="/img/alipay.jpeg">
        <span>alipay</span>
      </label>
  </div>
</div>

    <footer class="post-footer">
      <div class="post-tags">
          
          <a href="/tags/curl/">curl</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="https://emacsist.github.io/2020/01/06/swift%E7%BC%96%E7%A8%8B%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E8%AF%BB%E4%B9%A6/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">&lt;Swift编程权威指南&gt;读书</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        
          <a class="next" href="https://emacsist.github.io/2019/11/27/%E5%8A%A8%E6%80%81%E5%88%9B%E5%BB%BA%E7%BC%A9%E7%95%A5%E5%9B%BE/">
            <span class="next-text nav-default">动态创建缩略图</span>
            <span class="prev-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  <div id="comments-gitment"></div>
  <link rel="stylesheet" href="/lib/gitment/gitment-0.0.3.min.css">
    <script src="/lib/gitment/gitment-0.0.3.min.js"></script>
  <script type="text/javascript">
  const gitment = new Gitment({
    id: '2019-12-27 16:50:32 \x2b0800 CST',
    title: '\x3cCurl 必知必会\x3e读书',
    link: decodeURI(location.href),
    desc: 'curl 项目 Daniel Stenberg, 1996 发现 HttpGet (巴西人 Rafael Sagula). 接管并维护. 1997年 4 月 8 号',
    owner: 'emacsist',
    repo: 'emacsist.github.io',
    oauth: {
      client_id: 'd1456501fba5329f3afa',
      client_secret: 'd1ecbb7929a49de947215701320c60b312a72d3a'
    }
  })
  gitment.render('comments-gitment')
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://github.com/imsun/gitment">comments powered by gitment.</a></noscript>

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:emacsist@qq.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/emacsist2016" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://plus.google.com/u/0/114200054463267049438" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/emacsist" class="iconfont icon-github" title="github"></a>
      <a href="https://www.zhihu.com/people/emacist" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/people/emacsist/" class="iconfont icon-douban" title="douban"></a>
  <a href="https://emacsist.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <div class="busuanzi-footer">
    <span id="busuanzi_container_site_pv"> site pv: <span id="busuanzi_value_site_pv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
    <span class="division">|</span>
    <span id="busuanzi_container_site_uv"> site uv: <span id="busuanzi_value_site_uv"><img src="/img/spinner.svg" alt="spinner.svg"/></span> </span>
  </div>


  <span class="copyright-year">
    &copy; 
    
      2014 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">emacsist</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js?v=20171001"></script><script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  
<script type="text/javascript" src="/dist/even.min.js?v=3.1.1"></script>
  <script type="text/javascript">
    window.MathJax = {
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-118327923-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>









<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? "https://" : "http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1278300546'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s4.cnzz.com/z_stat.php%3Fid%3D1278300546%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</body>
</html>
